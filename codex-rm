#!/bin/bash
# Remove a Codex CLI instance
# Usage: ./codex-rm [instance-name]

set -e

if [ -z "$1" ]; then
    echo "Usage: ./codex-rm <instance-name>"
    echo ""
    echo "Available instances:"
    docker ps -a --filter "name=codex-" --format "  - {{.Names}}" | sed 's/-claude-code-1//' | sed 's/codex-//'
    exit 1
fi

INSTANCE_NAME="$1"
CONTAINER_NAME="codex-${INSTANCE_NAME}-claude-code-1"

# Check if container exists
if ! docker ps -aq -f name="^${CONTAINER_NAME}$" 2>/dev/null | grep -q .; then
    echo "âŒ No instance found: $INSTANCE_NAME"
    exit 1
fi

echo "ðŸ—‘ï¸  Removing Codex CLI instance: $INSTANCE_NAME"
docker stop "$CONTAINER_NAME" 2>/dev/null || true
docker rm "$CONTAINER_NAME"
echo "âœ“ Instance removed"
